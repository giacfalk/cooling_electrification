min370<-melt(min370,measure.vars=names(min370)[1:length(names(min370))-1], id.vars ="id")
min370$month = as.numeric(sub('.*\\.', '',min370$variable))
min370$variable=NULL
gc()
#
max370=as.data.frame(max370)
id = sf$id
max370 = cbind(max370, id)
max370<-melt(max370,measure.vars=names(max370)[1:length(names(max370))-1], id.vars ="id")
max370$month = as.numeric(sub('.*\\.', '',max370$variable))
max370$variable=NULL
gc()
#
#
all_245 = Reduce(function(x,y) merge(x,y,by=c("id", "month")) ,list(avg245, max245, min245))
all_370 = Reduce(function(x,y) merge(x,y,by=c("id", "month")) ,list(avg370, max370, min370))
#
reshape
colnames(all_245) <- c("id", "month", "avg", "max", "min")
colnames(all_370) <- c("id", "month", "avg", "max", "min")
#
#calculate CDDs
base_temp = 26
#
all_245$CDD_245 = 30 * ifelse(all_245$max<=base_temp, 0, ifelse( (all_245$avg<=base_temp) & (base_temp<all_245$max), (all_245$max-base_temp)/4, ifelse((all_245$min<=base_temp) & (base_temp<all_245$avg), ((all_245$max-base_temp)/2 - (base_temp-all_245$min)/4), all_245$avg-base_temp)))
#
all_370$CDD_370 = 30 * ifelse(all_370$max<=base_temp, 0, ifelse( (all_370$avg<=base_temp) & (base_temp<all_370$max), (all_370$max-base_temp)/4, ifelse((all_370$min<=base_temp) & (base_temp<all_370$avg), ((all_370$max-base_temp)/2 - (base_temp-all_370$min)/4), all_370$avg-base_temp)))
summary(all_245$CDD_245)
summary(all_245$avg)
summary(all_370$avg)
summary(all_370$max)
summary(all_245$max)
summary(all_245$CDD_245)
summary(all_245$CDD_370)
summary(all_370$CDD_370)
summary(all$CDD)
summary(all$max)
summary(all_245$max)
all_245$CDD_245
summary(all_245$CDD_245)
summary(all$CDD)
all$avg
summary(all$avg)
summary(all_245$avg)
11.03-8.42
summary(all$CDD)
summary(all_245$CDD_245)
2*30
3*30
summary(all_245$CDD_370)
summary(all_370$CDD_370)
p = read.csv("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/csvs/ponts05global.csv") %>% dplyr::select(id, left, right, bottom, top)
#
p$Y = (p$bottom + p$top)/2
p$X = (p$left + p$right)/2
#
all_m_245 = merge(all_245, p, by="id")
#
all_m_245 = split(all_m_245, all_245$month)
#
for (i in 1:12){
all_m_245[[i]] <- data.frame(all_m_245[[i]]$X, all_m_245[[i]]$Y, all_m_245[[i]]$CDD_245)
}
#
CDDs_245 <- list()
#convert to raster
for (i in 1:12){
CDDs_245[i] <- rasterFromXYZ(all_m_245[[i]], res=c(0.5, 0.5), crs = 4326)
}
#
CDDs_245 <- stack(CDDs_245)
#
setwd('D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA')
writeRaster(CDDs_245, "CDDs_2040_2060_245_global.tif")
#
#
#
all_m_370 = merge(all_370, p, by="id")
#
all_m_370 = split(all_m_370, all_370$month)
#
for (i in 1:12){
all_m_370[[i]] <- data.frame(all_m_370[[i]]$X, all_m_370[[i]]$Y, all_m_370[[i]]$CDD_370)
}
#
CDDs_370 <- list()
#convert to raster
for (i in 1:12){
CDDs_370[i] <- rasterFromXYZ(all_m_370[[i]], res=c(0.5, 0.5), crs = 4326)
}
#
CDDs_370 <- stack(CDDs_370)
#
setwd('D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA')
writeRaster(CDDs_370, "CDDs_2040_2060_370_global.tif")
base_temp = 26
all$CDD = 30 * ifelse(all$max<=base_temp, 0, ifelse( (all$avg<=base_temp) & (base_temp<all$max), (all$max-base_temp)/4, ifelse((all$min<=base_temp) & (base_temp<all$avg), ((all$max-base_temp)/2 - (base_temp-all$min)/4), all$avg-base_temp)))
p = read.csv("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/csvs/ponts05global.csv") %>% dplyr::select(id, left, right, bottom, top)
p$Y = (p$bottom + p$top)/2
p$X = (p$left + p$right)/2
all_m = merge(all, p, by="id")
all_m = split(all_m, all$month)
for (i in 1:12){
all_m[[i]] <- data.frame(all_m[[i]]$X, all_m[[i]]$Y, all_m[[i]]$CDD)
}
CDDs <- list()
#convert to raster
for (i in 1:12){
CDDs[i] <- rasterFromXYZ(all_m[[i]], res=c(0.5, 0.5), crs = 4326)
}
CDDs <- stack(CDDs)
setwd('D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA')
writeRaster(CDDs, "CDDs_2020_global.tif", overwrite=T)
CDDs_370
max(CDDs_370)
#Figure 1
#1A map of current CDDs among unelectrified
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(CDDs,
main="CDDs for pop. without electr. access, base T 22° C, year 2020", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1B map of RCP2.6 CDDs among unelectrified
png("CDD_245.png", width=1600, height=800, res=150)
print(levelplot(CDDs_245,
main="CDDs for pop. without electr. access, base T 22° C, 2041-2060, SSP245", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1C map of RCP4.5 CDDs among unelectrified
png("CDD_370.png", width=1600, height=800, res=150)
print(levelplot(CDDs_370,
main="CDDs for pop. without electr. access, base T 22° C, 2041-2060, SSP370", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
library(rasterVis)
library(maps)
library(mapdata)
library(maptools)
ext <- as.vector(extent(CDDs))
boundaries <- map('worldHires', fill=TRUE,
xlim=ext[1:2], ylim=ext[3:4],
plot=FALSE)
IDs <- sapply(strsplit(boundaries$names, ":"), function(x) x[1])
bPols <- map2SpatialPolygons(boundaries, IDs=IDs,
proj4string=CRS(projection(CDDs)))
my.at <- c(15, 30, 60, 120, 240, 480, 960)
myColorkey <- list(at=my.at, ## where the colors change
labels=list(
at=my.at ## where to print labels
))
names(CDDs) <- month.abb
#Figure 1
#1A map of current CDDs among unelectrified
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(CDDs,
main="CDDs for pop. without electr. access, base T 22° C, year 2020", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1B map of RCP2.6 CDDs among unelectrified
png("CDD_245.png", width=1600, height=800, res=150)
print(levelplot(CDDs_245,
main="CDDs for pop. without electr. access, base T 22° C, 2041-2060, SSP245", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1C map of RCP4.5 CDDs among unelectrified
png("CDD_370.png", width=1600, height=800, res=150)
print(levelplot(CDDs_370,
main="CDDs for pop. without electr. access, base T 22° C, 2041-2060, SSP370", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
png("CDD_today.png", width=1600, height=800, res=350)
print(levelplot(CDDs,
main="CDDs for pop. without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
png("CDD_today.png", width=1600*3, height=800*3, res=450)
print(levelplot(CDDs,
main="CDDs for pop. without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
png("CDD_today.png", width=1600*2.5, height=800*2.5, res=150)
print(levelplot(CDDs,
main="CDDs for pop. without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
png("CDD_today.png", width=3200, height=1600, res=150)
print(levelplot(overlay,
main="CDDs for pop. without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=3200, height=1600, res=150)
print(levelplot(overlay,
main="CDDs for pop. without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#Figure 1
#1A map of current CDDs among unelectrified
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=3200, height=1600, res=150)
print(levelplot(CDDs,
main="CDDs for pop. without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
pop <- raster(' C:/Users/GIACOMO/Google Drive/pop_wp.tif')
sum(values(pop), na.rm = T)
8920462174/10e9
8920462174/1000000000
pop_noaccess <- raster(' C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')
sum(values(pop), na.rm = T)
sum(values(pop_noaccess), na.rm = T)
8920462174/73000000000
8920462174/7300000000
pop_noaccess <- raster(' C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')/1.221981
sum(values(pop_noaccess), na.rm = T)
#read el. access
noacc18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')/1.221981
res(noacc18)
0.5/noacc18
0.5/0.08983153
CDDs_370 <- stack('D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/CDDs_2040_2060_370_global.tif')
CDDs_245 <- stack('D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/CDDs_2040_2060_245_global.tif')
#################
#read el. access
noacc18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')/1.221981
noacc18<-aggregate(noacc18, fact=5.565974, fun=sum, na.rm=TRUE)
writeRaster(noacc18, "D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/noacc18.tif", overwrite=T)
#
noacc18<-raster("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/noacc18.tif")
# read pop
pop18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_wp.tif')/1.221981
pop18<-aggregate(pop18, fact=5.565974, fun=sum, na.rm=TRUE)
writeRaster(noacc18, "D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/pop18.tif", overwrite=T)
#
pop18<-raster("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/pop18.tif")
##
crs(CDDs) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
noacc18_current <- projectRaster(noacc18, CDDs)
pop_current <- projectRaster(pop, CDDs)
overlay_current <- overlay(noacc18_current, CDDs, pop_current, fun = function(x, y, z) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_current<-stack(overlay_current)
#
crs(CDDs_245) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
noacc18_245 <- projectRaster(noacc18, CDDs_245)
pop_245 <- projectRaster(pop, CDDs_245)
overlay_245 <- overlay(noacc18_245, CDDs_245, pop_245, fun = function(x, y) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_245<-stack(overlay_245)
#
crs(CDDs_370) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
noacc18_370 <- projectRaster(noacc18, CDDs_370)
pop_370 <- projectRaster(pop, CDDs_370)
overlay_370 <- overlay(noacc18_370, CDDs_370, pop_370, fun = function(x, y) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_370<-stack(overlay_370)
############################
#Figure 1
#1A map of current CDDs among unelectrified
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(overlay,
main="CDDs in areas without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1B map of RCP2.6 CDDs among unelectrified
png("CDD_245.png", width=1600, height=800, res=150)
print(levelplot(overlay_245,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP245", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1C map of RCP4.5 CDDs among unelectrified
png("CDD_370.png", width=1600, height=800, res=150)
print(levelplot(overlay_370,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP370", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#
noacc18<-raster("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/noacc18.tif")
#
pop18<-raster("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/pop18.tif")
##
crs(CDDs) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
noacc18_current <- projectRaster(noacc18, CDDs)
pop_current <- projectRaster(pop, CDDs)
sum(values(pop_current), na.rm = T)
#read el. access
noacc18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')/1.221981
#read el. access
noacc18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')/1.221981
sum(values(noacc18), na.rm = T)
sum(values(pop18), na.rm = T)
# read pop
pop18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_wp.tif')/1.221981
sum(values(pop18), na.rm = T)
res(CDDs)
res(noacc18)
0.5/0.08983153
noacc18<-aggregate(noacc18, fact=5.565974, fun=sum, na.rm=TRUE)
sum(values(noacc18), na.rm = T)
writeRaster(noacc18, "D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/noacc18.tif", overwrite=T)
# read pop
pop18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_wp.tif')/1.221981
pop18<-aggregate(pop18, fact=5.565974, fun=sum, na.rm=TRUE)
sum(values(pop18), na.rm = T)
writeRaster(noacc18, "D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/pop18.tif", overwrite=T)
res(pop18)
##
crs(CDDs) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
noacc18_current <- projectRaster(noacc18, CDDs)
sum(values(noacc18_current), na.rm = T)
2173232117/1803561411
CDD_current <- projectRaster(CDDs, noacc18)
overlay_current <- overlay(noacc18, CDD_current, pop_current, fun = function(x, y, z) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_current <- overlay(noacc18, CDD_current, pop18, fun = function(x, y, z) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_current<-stack(overlay_current)
#
crs(CDDs_245) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_245 <- projectRaster(CDDs_245, noacc18)
overlay_245 <- overlay(noacc18, CDD_245, pop18, fun = function(x, y) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
#
crs(CDDs_245) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_245 <- projectRaster(CDDs_245, noacc18)
overlay_245 <- overlay(noacc18, CDD_245, pop18, fun = function(x, y) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_245 <- overlay(noacc18, CDD_245, pop18, fun = function(x, y, z) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_245<-stack(overlay_245)
#
crs(CDDs_370) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_370 <- projectRaster(CDDs_370, noacc18)
overlay_370 <- overlay(noacc18, CDD_370, pop18, fun = function(x, y, z) {
y[x==0] <- NA
y[z==0] <- NA
return(y)
})
overlay_370<-stack(overlay_370)
#Figure 1
#1A map of current CDDs among unelectrified
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(overlay,
main="CDDs in areas without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1B map of RCP2.6 CDDs among unelectrified
png("CDD_245.png", width=1600, height=800, res=150)
print(levelplot(overlay_245,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP245", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1C map of RCP4.5 CDDs among unelectrified
png("CDD_370.png", width=1600, height=800, res=150)
print(levelplot(overlay_370,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP370", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(overlay_current,
main="CDDs in areas without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
plot(noacc18)
##
crs(CDDs) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_current <- projectRaster(CDDs, noacc18)
overlay_current <- overlay(noacc18, CDD_current, pop18, fun = function(x, y, z) {
y[x<100] <- NA
y[z==0] <- NA
return(y)
})
overlay_current<-stack(overlay_current)
#
crs(CDDs_245) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_245 <- projectRaster(CDDs_245, noacc18)
overlay_245 <- overlay(noacc18, CDD_245, pop18, fun = function(x, y, z) {
y[x<100] <- NA
y[z==0] <- NA
return(y)
})
overlay_245<-stack(overlay_245)
#
crs(CDDs_370) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_370 <- projectRaster(CDDs_370, noacc18)
overlay_370 <- overlay(noacc18, CDD_370, pop18, fun = function(x, y, z) {
y[x<100] <- NA
y[z==0] <- NA
return(y)
})
overlay_370<-stack(overlay_370)
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(overlay_current,
main="CDDs in areas without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1B map of RCP2.6 CDDs among unelectrified
png("CDD_245.png", width=1600, height=800, res=150)
print(levelplot(overlay_245,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP245", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1C map of RCP4.5 CDDs among unelectrified
png("CDD_370.png", width=1600, height=800, res=150)
print(levelplot(overlay_370,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP370", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
is.na(pop18)
#read el. access
noacc18 <- raster('C:/Users/GIACOMO/Google Drive/pop_noaccess.tif')/1.221981
noacc18<-aggregate(noacc18, fact=5.565974, fun=sum, na.rm=TRUE)
writeRaster(noacc18, "D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/noacc18.tif", overwrite=T)
#
noacc18<-raster("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/noacc18.tif")
noacc18[is.na(noacc18)] <- 0
# read pop
pop18 <- raster(' C:/Users/GIACOMO/Google Drive/pop_wp.tif')/1.221981
pop18<-aggregate(pop18, fact=5.565974, fun=sum, na.rm=TRUE)
writeRaster(noacc18, "D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/pop18.tif", overwrite=T)
#
pop18<-raster("D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/Latent demand air cooling/cooling_electricity_SSA/pop18.tif")
pop18[is.na(pop18)] <- 0
##
crs(CDDs) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_current <- projectRaster(CDDs, noacc18)
overlay_current <- overlay(noacc18, CDD_current, pop18, fun = function(x, y, z) {
y[x<100] <- NA
y[z==0] <- NA
return(y)
})
overlay_current<-stack(overlay_current)
#
crs(CDDs_245) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_245 <- projectRaster(CDDs_245, noacc18)
overlay_245 <- overlay(noacc18, CDD_245, pop18, fun = function(x, y, z) {
y[x<100] <- NA
y[z==0] <- NA
return(y)
})
overlay_245<-stack(overlay_245)
#
crs(CDDs_370) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
crs(noacc18) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
CDD_370 <- projectRaster(CDDs_370, noacc18)
overlay_370 <- overlay(noacc18, CDD_370, pop18, fun = function(x, y, z) {
y[x<100] <- NA
y[z==0] <- NA
return(y)
})
overlay_370<-stack(overlay_370)
############################
#Figure 1
#1A map of current CDDs among unelectrified
names(CDDs) <- month.abb
names(CDDs_245) <- month.abb
names(CDDs_370) <- month.abb
png("CDD_today.png", width=1600, height=800, res=150)
print(levelplot(overlay_current,
main="CDDs in areas without electr. access, base T 26° C, 1970-2000, baseline", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1B map of RCP2.6 CDDs among unelectrified
png("CDD_245.png", width=1600, height=800, res=150)
print(levelplot(overlay_245,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP245", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
#1C map of RCP4.5 CDDs among unelectrified
png("CDD_370.png", width=1600, height=800, res=150)
print(levelplot(overlay_370,
main="CDDs in areas without electr. access, base T 26° C, 2041-2060, SSP370", at=my.at, colorkey=myColorkey,  par.settings = YlOrRdTheme, xlab="Longitude", ylab="Latitude") + layer(sp.polygons(bPols)))
dev.off()
global_shape<-readOGR('D:/OneDrive - FONDAZIONE ENI ENRICO MATTEI/Current papers/CLEXREL/Data/gadm36_levels_shp/gadm36_0.shp')
CDDs_extract<-raster::extract(overlay, global_shape, fun=sum, na.rm=TRUE)
CDDs_245_extract<-raster::extract(overlay_245, global_shape, fun=sum, na.rm=TRUE)
CDDs_extract<-raster::extract(overlay_current, global_shape, fun=sum, na.rm=TRUE)
CDDs_245_extract<-raster::extract(overlay_245, global_shape, fun=sum, na.rm=TRUE)
global = as.data.frame(global_shape)
global = cbind(global, CDDs_extract)
View(global)
